// Generated by CoffeeScript 1.7.1
(function() {
  var d, handle_get_settings_success, handle_patch_success, request_get, request_patch, show_ui, update_ui_values;

  d = document;

  request_patch = function(path, value) {
    var body, client;
    client = new XMLHttpRequest();
    client.addEventListener('load', handle_patch_success);
    client.open('PATCH', '/settings');
    client.setRequestHeader('Content-Type', 'application/json-patch+json');
    body = [
      {
        'op': 'replace',
        'path': path,
        'value': value
      }
    ];
    client.send(JSON.stringify(body));
  };

  handle_patch_success = function() {};

  update_ui_values = function(settings) {
    d.getElementById('default_email').value = settings.default_email;
    d.getElementById('daily_hour').value = settings.hour;
    d.getElementById('daily_timezone').value = settings.time_zone;
  };

  show_ui = function() {
    d.getElementById('loading').style.display = 'none';
    return d.getElementById('settings_main').style.display = 'inline-block';
  };

  request_get = function(url, success_callback) {
    var client;
    client = new XMLHttpRequest();
    client.addEventListener('load', success_callback);
    client.responseType = 'json';
    client.open('GET', url);
    client.setRequestHeader('Accept', 'application/json');
    client.send();
  };

  handle_get_settings_success = function() {
    var settings;
    console.log(this);
    console.log(this.response);
    settings = this.response;
    update_ui_values(settings);
    show_ui();
  };

  request_get('/settings', handle_get_settings_success);

  d.addEventListener('DOMContentLoaded', function() {
    var delete_button;
    delete_button = d.getElementById('button_delete');
    d.getElementById('checkbox_enable_delete').addEventListener('change', function() {
      return delete_button.disabled = !this.checked;
    });
    return delete_button.addEventListener('click', function() {
      return alert('Coming soon!');
    });
  });

}).call(this);
